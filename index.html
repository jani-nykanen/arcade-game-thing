<body onload="start()">

<div id="canvasDiv" style="position:absolute; top:0px; left:0px; z-index:1; cursor: none;">
  <canvas id="glCanvas" width="640" height="480">
    Your browser doesn't appear to support the  <code>&lt;canvas&gt;</code> element.
  </canvas>
</div>

<script id="frag-default" type="x-shader/x-fragment"> 

  precision mediump float;

  #define M_PI 3.1415926535897932384626433832795

  varying highp vec2 UV;
  uniform sampler2D texSampler;

  uniform vec4 tintColor;

  void main()
  {
      vec4 color = texture2D( texSampler, UV ).rgba * tintColor;
      if(color.a == 0.0) discard;
      gl_FragColor = color;
  } 

</script>

<script id="frag-limit" type="x-shader/x-fragment"> 

  precision mediump float;

  #define M_PI 3.1415926535897932384626433832795

  varying highp vec2 UV;
  uniform sampler2D texSampler;

  uniform vec4 tintColor;

  void main()
  {
      vec4 color = texture2D( texSampler, UV ).rgba * tintColor;
      if(color.a == 0.0) discard;

      color.r = (floor(color.r * 255.0 / 8.0) * 8.0)/255.0;
      color.g = (floor(color.g * 255.0 / 8.0) * 8.0)/255.0;
      color.b = (floor(color.b * 255.0 / 8.0) * 8.0)/255.0;

      gl_FragColor = color;
  } 

</script>

<script id="frag-notex" type="x-shader/x-fragment"> 

  precision mediump float;

  uniform vec4 tintColor;

  void main()
  {
      vec4 color = tintColor;
      if(color.a == 0.0) discard;
      gl_FragColor = color;
  } 

</script>

<script id="frag-fog" type="x-shader/x-fragment"> 

  precision mediump float;

  #define M_PI 3.1415926535897932384626433832795

  varying highp vec2 UV;
  uniform sampler2D texSampler;
  uniform vec4 tintColor;

  uniform vec4 fogColor;
  uniform float fogMin;
  uniform float fogMax;

  void main()
  {
      vec4 color = texture2D( texSampler, UV ).rgba * tintColor;
      
      if(color.a == 0.0) discard;

      float dist = gl_FragCoord.z / gl_FragCoord.w;
      float fogAmount = clamp((dist-fogMin)/(fogMax-fogMin),0.0,1.0);

      color = mix(color,fogColor,fogAmount);

      gl_FragColor = color;
    
  } 

</script>

<script id="vertex-default" type="x-shader/x-vertex">

  precision mediump float;

  attribute vec3 vertexPos;
  attribute vec2 vertexUV;

  varying highp vec2 UV;

  uniform mat4 model;
  uniform mat4 view;
  uniform mat4 projection;

  void main()
  {
    UV = vertexUV;
    gl_Position = projection * view * model * vec4(vertexPos,1.0);
  }
</script> 

<script id="vertex-notex" type="x-shader/x-vertex">

  precision mediump float;

  attribute vec3 vertexPos;

  uniform mat4 model;
  uniform mat4 view;
  uniform mat4 projection;

  void main()
  {
    gl_Position = projection * view * model * vec4(vertexPos,1.0);
  }
</script> 

<script src="js/library/gl-matrix-min.js"></script>

<script src="js/engine/loader.js"></script>
<script src="js/engine/bitmap.js"></script>
<script src="js/engine/transform.js"></script>
<script src="js/engine/effects.js"></script>
<script src="js/engine/mesh.js"></script>
<script src="js/engine/shapes.js"></script>
<script src="js/engine/framebuffer.js"></script>
<script src="js/engine/bitmapfont.js"></script>
<script src="js/engine/graphics.js"></script>
<script src="js/engine/utility.js"></script>
<script src="js/engine/controls.js"></script>
<script src="js/engine/sprite.js"></script>
<script src="js/engine/core.js"></script>

<script src="js/application/vpad.js"></script>
<script src="js/application/scene.js"></script>
<script src="js/application/assets.js"></script>
<script src="js/application/application.js"></script>

<script src="js/application/game/camera.js"></script>
<script src="js/application/game/gas.js"></script>
<script src="js/application/game/player.js"></script>
<script src="js/application/game/gameobjects.js"></script>
<script src="js/application/game/stage.js"></script>
<script src="js/application/game/game.js"></script>

<script src="js/main.js"></script>

<style type="text/css">
  body {
         overflow:hidden;
       }
</style>

</body>